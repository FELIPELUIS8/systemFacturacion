<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">



    <body>

        <ui:composition template="./../../Plantilla/plantilla1.xhtml">

            <ui:define name="content">
                <h2>REALIZAR VENTA</h2>
                <h:form id="formFactura">
                    <p:panel header="_*_" style="width: 1000px; margin: 0 auto; text-align: center">
                        <p:layout id="capaDatosClienteFactura" style="width: 100%; height: 250px">
                            <p:layoutUnit id="datosCliente" position="center" style="padding: 5px; text-align: justify;
                                          font-size: 14px;" size="300">
                                <h:panelGrid id="gridBuscarporCodigoCliente" columns="5">
                                    <p:outputLabel value="Codigo cliente:" style="font-weight: bold;font-size: 16px"/>
                                    <p:inputText value="#{facturaBean.codigoCliente}" size="12" style="margin-left: 5px">
                                        <p:ajax event="keyup" listener="#{facturaBean.agregarDatosCliente2()}"
                                                update=":formFactura:gridDatosCliente"/>
                                    </p:inputText>

                                    <p:commandButton  value="" oncomplete="PF('dialogClientes').show()" icon="ui-icon-search" title="Buscar" style="width: 70px; height: 30px; background-size: cover;font-size: 50px; margin: 5px "/>
                                    <p:outputLabel value="Fecha:" style="font-weight: bold;font-size: 16px"/>
                                    <p:outputLabel value="Fecha" style="font-weight: bold;font-size: 16px"/>

                                </h:panelGrid>

                                <h:panelGrid id="gridBuscarporNombreCliente" columns="2">

                                    <p:outputLabel value="Nombre cliente:" style="font-weight: bold;font-size: 16px"/>
                                    <p:inputText value="#{facturaBean.nombres}" size="12" style="margin-left: 1px;">
                                        <p:ajax event="keyup" listener="#{facturaBean.agregarDatosCliente3()}"
                                                update=":formFactura:gridDatosCliente"/>
                                    </p:inputText>
                                </h:panelGrid>

                                <h:panelGrid id="gridBuscarporIdentificacionCliente" columns="2">

                                    <p:outputLabel value="IdentificaciÃ³n:" style="font-weight: bold;font-size: 16px"/>
                                    <p:inputText value="#{facturaBean.identificacion}" size="12" style="margin: 6px; margin-left: 13px">
                                        <p:ajax event="keyup" listener="#{facturaBean.agregarDatosCliente4()}"
                                                update=":formFactura:gridDatosCliente"/>

                                    </p:inputText>
                                </h:panelGrid>


                                <p:separator/>

                                <h:panelGrid id="gridDatosCliente" columns="2">
                                    <p:outputLabel value="Nombre:" style="font-weight: bold;font-size: 16px"/>
                                    <p:outputLabel id="iblNombreCliente" value="#{facturaBean.cliente.nombres} #{facturaBean.cliente.apellidos}"/>

                                    <p:outputLabel value="Nit o CC:" style="font-weight: bold;font-size: 16px"/>
                                    <p:outputLabel id="iblNCCliente" value="#{facturaBean.cliente.identificacion}"/>

                                    <p:outputLabel value="Celular:" style="font-weight: bold;font-size: 16px"/>
                                    <p:outputLabel id="iblCelularCliente" value="#{facturaBean.cliente.celular}"/>

                                    <p:outputLabel value="Direccion:" style="font-weight: bold;font-size: 16px"/>
                                    <p:outputLabel id="iblDireccionCliente" value="#{facturaBean.cliente.dirrecion}"/>

                                    <p:outputLabel value="Email:" style="font-weight: bold;font-size: 16px"/>
                                    <p:outputLabel id="iblEmailCliente" value="#{facturaBean.cliente.email}"/>


                                </h:panelGrid>

                            </p:layoutUnit>


                            <p:layoutUnit id="datosFactura" position="east" style="padding: 5px; text-align: center;
                                          font-size: 14px;" size="300">
                                <h:panelGrid columns="1" style="font-size: 24px; font-weight: bold; margin-top: 30px; margin: 0 auto">
                                    FACTURA
                                    <p:outputLabel value="000001"/>
                                </h:panelGrid>


                            </p:layoutUnit>
                        </p:layout>
                        <p:separator/>
                        <h:panelGrid columns="3">
                            <p:outputLabel value="Codigo barra:" style=" margin: 6px; font-weight: bold;font-size: 16px; "/>
                            <p:inputText id="txtBuscarCodigoBarra" value="#{facturaBean.codigobarra}" size="12" style="margin-left: 10px">
                                <p:ajax event="keyup" listener="#{facturaBean.agregarDatosProducto1()}"
                                        update=":formFactura:tablaProductosFactura: formFactura:txtBuscarCodigoBarra"/>
                            </p:inputText>

                            <p:commandButton value="" icon="ui-icon-search" title="Buscar" oncomplete="PF('dialogProductos').show()" style="width: 70px; height: 30px; background-size: cover; font-size: 50px; margin: 5px"
                                             update=":formFactura:digProductos"/>
                        </h:panelGrid>

                        <h:panelGrid columns="2">
                            <p:outputLabel value="Nombre prod :" style="font-weight: bold;font-size: 16px;margin:6px"/>
                            <p:inputText id="txtBuscarPorNombre"  value="#{facturaBean.nombreproducto}" size="12" style="margin: 3px">
                                <p:ajax event="keyup" listener="#{facturaBean.agregarDatosProducto2()}"
                                        update="formFactura:tablaProductosFactura: formFactura:txtBuscarPorNombre"/>
                            </p:inputText>


                        </h:panelGrid>
                        <p:separator/>
                        <p:dataTable id="tablaProductosFactura" var="item" value="#{facturaBean.listaDetalleFactura}">

                            <p:column headerText="Codigo Barra">
                                <h:outputText value="#{item.codbarra}"/>
                            </p:column>

                            <p:column headerText="Producto">
                                <h:outputText value="#{item.nombreproducto}"/>
                            </p:column>

                            <p:column headerText="Cantidad">
                                <h:outputText value="#{item.cantidad}"/>
                            </p:column>

                            <p:column headerText="Precio venta">
                                <h:outputText value="#{item.precioventa}"/>
                            </p:column>

                            <p:column headerText="Total">
                                <h:outputText value="#{item.total}"/>
                            </p:column>
                        </p:dataTable>

                        <p:outputLabel value="TOTAL VENTA"/>
                        $ <p:outputLabel value="Total a vender"/>  
                        <p:separator/>

                        <p:commandButton  value="" icon="ui-icon-disk" title="Registrar" style="width: 70px; height: 40px; background-size: cover;font-size: 50px; "/>
                        <p:commandButton  value="" icon="ui-icon-print" title="Imprimir" style="width: 70px; height: 40px; background-size: cover;font-size: 50px "/>
                        <p:commandButton  value="" icon="ui-icon-close" title="Cancelar" style="width: 70px; height: 40px; background-size: cover;font-size: 50px" />

                    </p:panel>

                    <!--Dialog para mostrar todos los clientes del sistema-->
                    <p:dialog id="digClientes" widgetVar="dialogClientes" modal="true" resizable="false"
                              showEffect="explode" hideEffect="explode">

                        <p:dataTable id="tablaClientes" style="width: 1000px" paginator="true" paginatorPosition="top"
                                     var= "ct"  value="#{clienteBean.listaCliente}" emptyMessage="No hay datos de clientes">
                            <p:column headerText="Codigo">
                                <h:outputText value="#{ct.codcliente}"/> 
                            </p:column>                                 
                            <p:column headerText="Nombres y Apellidos">
                                <h:outputText value="#{ct.nombres} #{ct.apellidos}"/> 
                            </p:column>

                            <p:column headerText="Identificacion">
                                <h:outputText value="#{ct.identificacion}"/> 
                            </p:column>


                            <p:column headerText="Celular">
                                <h:outputText value="#{ct.celular}"/> 
                            </p:column>

                            <p:column headerText="Direccion">
                                <h:outputText value="#{ct.dirrecion}"/> 
                            </p:column>


                            <p:column headerText="Email">
                                <h:outputText value="#{ct.email}"/> 
                            </p:column>

                            <p:column headerText="">
                                <p:commandButton value="Seleccionar" actionListener="#{facturaBean.agregarDatosCliente(ct.codcliente)}"
                                                 oncomplete="PF('dialogClientes').hide();"
                                                 update=":formFactura:gridDatosCliente"> 
                                </p:commandButton>
                            </p:column>

                        </p:dataTable>
                        <p:commandButton value="" icon="ui-icon-close" title="Cerrar" oncomplete="PF('dialogClientes').hide();" 
                                         style="width: 70px; height: 40px; background-size: cover;font-size: 50px"/>
                    </p:dialog>

                    <!--Dialog para mostrar todos los productos del sistema-->
                    <p:dialog id="digProductos" widgetVar="dialogProductos" modal="true" resizable="false"
                              showEffect="explode" hideEffect="explode">

                        <p:dataTable id="tablaProductos" style="width: 1000px" paginator="true" paginatorPosition="top"
                                     var= "pro"  value="#{productoBean.listaProducto}" emptyMessage="No hay datos de producto">
                            <p:column headerText="CodigoProducto">
                                <h:outputText value="#{pro.codproducto}"/> 
                            </p:column>                                 
                            <p:column headerText="NombresProducto">
                                <h:outputText value="#{pro.nombreproducto}"/> 
                            </p:column>

                            <p:column headerText="PrecioVenta">
                                <h:outputText value="#{pro.precioventa}"/> 
                            </p:column>


                            <p:column headerText="StockMinimo">
                                <h:outputText value="#{pro.stockminimo}"/> 
                            </p:column>

                            <p:column headerText="StockActual">
                                <h:outputText value="#{pro.stockactual}"/> 
                            </p:column>


                            <p:column headerText="CodigoBarra">
                                <h:outputText value="#{pro.codigobarra}"/> 
                            </p:column>

                            <p:column headerText="">
                                <p:commandButton value="Seleccionar" actionListener="#{facturaBean.agregarDatosProducto(pro.codigobarra)}"
                                                 oncomplete="PF('dialogProductos').hide();"
                                                 update=":formFactura:tablaProductosFactura"> 
                                </p:commandButton>
                            </p:column>
                            

                        </p:dataTable>
                        <p:commandButton value="" icon="ui-icon-close" title="Cerrar" oncomplete="PF('dialogProductos').hide();" 
                                         style="width: 70px; height: 40px; background-size: cover;font-size: 50px"/>
                    </p:dialog>


                </h:form>

            </ui:define>

        </ui:composition>

    </body>
</html>

